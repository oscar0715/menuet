---
title: æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ_15213_CH2
tags:
  - 15213
  - CSAPP
categories:
  - Technology
  - CSAPP
date: 2016-05-16 09:06:14
---
æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ
Computer Systems
A Programmer Perspective

CMU 15213

CH2 ä¿¡æ¯çš„è¡¨ç¤ºå’Œç®¡ç†
<!-- more -->

***

### ç»ƒä¹ é¢˜ 2.48
åè¿›åˆ¶æ•´æ•°: 3510593 
åå…­è¿›åˆ¶è¡¨ç¤º: Ox00359141

å•ç²¾åº¦æµ®ç‚¹æ•°: 3510593.0
åå…­è¿›åˆ¶è¡¨ç¤º: Ox4A564504

é—®é¢˜: æ¨å¯¼å‡ºè¿™ä¸ªæµ®ç‚¹è¡¨ç¤ºï¼Œå¹¶è§£ææ•´æ•°å’Œæµ®ç‚¹æ•°è¡¨ç¤ºçš„ä½ä¹‹é—´çš„å…³ç³»

æ•´æ•°äºŒè¿›åˆ¶ ==> å•ç²¾åº¦äºŒè¿›åˆ¶
1. æ•´æ•°3510593çš„äºŒè¿›åˆ¶è¡¨ç¤º:
        0000 0000 0011 0101 1001 0001 0100 0001
2. å°æ•°ç‚¹å·¦ç§»åˆ°æœ€é«˜ä½å³è¾¹ï¼Œå·¦ç§»21ä½(E=21),å¾—åˆ°å°¾æ•°M:
        1.1 0101 1001 0001 0100 0001 x 2^20 
3. å–å°æ•°éƒ¨åˆ†ï¼Œåœ¨æœ«å°¾è¡¥2ä¸ªé›¶ï¼ˆå› ä¸ºå•ç²¾åº¦å°¾æ•°ä¸º23ä½ï¼‰, å¾—åˆ°f:
        1 0101 1001 0001 0100 0001 00
        // å•ç²¾åº¦è§„æ ¼åŒ–çš„å€¼, `M = 1+f`
5. é˜¶ç çš„å€¼ E = e-Biasï¼Œ eä¸ºæ— ç¬¦å·æ•°ï¼Œæ­¤å¤„ç”¨ E+bias è¿˜åŸe:
        å•ç²¾åº¦ä¸­ Bias = 2^7-1 = 127
        e = E+Bias = 21 + 127 = 148  ==> 1001 0100
        å¾—åˆ°å•ç²¾åº¦å€¼äºŒè¿›åˆ¶è¡¨ç¤º 
        0 10010100 101 0110 0100 0101 0000 0100
        ä¸Ox4A564504 = 0 10010100 101 0110 0100 0101 0000 0100 ç›¸åŒ

å•ç²¾åº¦äºŒè¿›åˆ¶ ==> æ•´æ•°äºŒè¿›åˆ¶
* æ¢ä¸€ä¸ªæ–¹å‘
        0 10010100 10101100100010100000100
        M = 1.10101100100010100000100
        e = 10010100b = 148
        E = 148 - 127 = 21
        å°æ•°ç‚¹å³ç§»21ä½
        V = 1 1010 1100 1000 1010 0000 1.00

***

### ç»ƒä¹ é¢˜ 2.49
A. å¯¹äºå…·æœ‰nä½çš„å°æ•°çš„æµ®ç‚¹æ ¼å¼ï¼Œç»™å‡ºä¸èƒ½å‡†ç¡®æè¿°çš„æœ€å°æ­£æ•´æ•°å…¬å¼ï¼Œå‡è®¾é˜¶ç å­—æ®µé•¿åº¦kè¶³å¤Ÿå¤§ï¼Œå¯ä»¥è¡¨ç¤ºçš„é˜¶ç èŒƒå›´ä¸ä¼šé™åˆ¶è¿™ä¸ªé—®é¢˜ã€‚

1. åªæœ‰è§„æ ¼æ•°æ‰èƒ½æœ‰å¯èƒ½å‡ºç°æ•´æ•°ï¼Œæ‰€ä»¥åªè€ƒè™‘é˜¶ç ä¸å…¨ä¸ºé›¶ã€‚
2. å°æ•°ä½éœ€è¦n+1ä½æ‰èƒ½è¡¨ç¤ºï¼Œæ‰€ä»¥å°æ•°éƒ¨åˆ†ä¸º nä¸ª0åŠ æœ€ä½ä½çš„ä¸€ä¸ª1ï¼Œ
$$f=2^{(-n-1)}$ï¼Œ $M=1+f=1+2^{(-n-1)}$$
3. ç”¨é˜¶ç æŠµæ¶ˆå°æ•°éƒ¨åˆ† æ‰€ä»¥ $2^E = 2^{n+1}$
$$V=2^E \times M=(1+2^{(-n-1)}) \times 2^{n+1} = 2^{n+1}+1$$

B. å¯¹äºå•ç²¾åº¦æ ¼å¼23ä½å°æ•°ä½ï¼Œè¿™ä¸ªæ•´æ•°çš„æ•°å­—å€¼æ˜¯å¤šå°‘ï¼Ÿ
$$ 2^{23+1}+1 = 16,777,217$$

***
### ç»ƒä¹ é¢˜ 2.50
æ ¹æ®èˆå…¥åˆ°å¶æ•°åŸåˆ™ï¼Œå°†ä¸‹åˆ—äºŒè¿›åˆ¶å°æ•°å€¼èˆå…¥åˆ°æœ€æ¥è¿‘çš„äºŒåˆ†ä¹‹ä¸€ï¼ˆå°æ•°ç‚¹åä¸€ä½ï¼‰
1. 10.010 ==> 10.0 ï¼ˆå‘ä¸‹èˆå…¥åˆ°å¶æ•°ï¼‰
2. 10.011 ==> 10.1 ï¼ˆèˆå…¥åˆ°æœ€æ¥è¿‘çš„ï¼‰
3. 10.110 ==> 11.0 ï¼ˆå‘ä¸Šèˆå…¥åˆ°å¶æ•°ï¼‰
4. 11.001 ==> 11.0 ï¼ˆèˆå…¥åˆ°æœ€æ¥è¿‘çš„ï¼‰

***

### ç»ƒä¹ é¢˜ 2.51
å®šä¹‰ 0.1 = 0.0001 1001 1001 1001 1001 100
x =0.0001 1001 1001 1001 1001 1001 [1001]
1. ä½¿ç”¨èˆå…¥åˆ°å¶æ•°åŸåˆ™ x'=0.0001 1001 1001 1001 1001 101 ï¼ˆèˆå…¥åˆ°æœ€æ¥è¿‘çš„ï¼‰
2. x'-0.1 = 0.0000 0000 0000 0000 0000 0000 [0110] ï¼ˆğŸ¶ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼‰

***

### ç»ƒä¹ é¢˜ 2.52
åŸºäºIEEEæµ®ç‚¹æ ¼å¼çš„6ä½æµ®ç‚¹è¡¨ç¤º
æ ¼å¼A: 3ä¸ªé˜¶ç ä½kï¼Œ4ä¸ªå°æ•°ä½nï¼Œåç½®å€¼ä¸º$2^{3-1}-1=3$
æ ¼å¼B: 3ä¸ªé˜¶ç ä½kï¼Œ4ä¸ªå°æ•°ä½nï¼Œåç½®å€¼ä¸º$2^{4-1}-1=7$
ç»™å‡ºAæ ¼å¼çš„ä½æ¨¡å¼ï¼Œå°†å…¶è½¬åŒ–ä¸ºBæ ¼å¼ä¸­æœ€æ¥è¿‘çš„å€¼


1. 011 0000
$A: 2^E=2^{3-3}=1ï¼Œ  <br/>M=1ï¼Œ  <br/>V=1 $
$B: 2^E=2^{7-7}=1ï¼Œ  <br/>M=1ï¼Œ  <br/>V=1 $
==> B: 0111 000

2. 101 1110
$A: 2^E=2^{5-3}=4ï¼Œ  <br/>M=\frac{14+16}{16}=\frac{15}{8}  $
$B: 2^E=2^{9-7}=4ï¼Œ  <br/>M=\frac{7+8}{8}=\frac{15}{8} $
==> B: 1001 111

3. 010 1001
$A: 2^E=2^{2-3}=\frac{1}{2}ï¼Œ  <br/>M=\frac{9+16}{16}=\frac{25}{16} ï¼Œ  <br/> V=\frac{25}{32} $
1001 å‘ä¸‹èˆå…¥==> 100
$B: 2^E=2^{6-7}=-1ï¼Œ  <br/>M=\frac{4+8}{8}=\frac{3}{2}ï¼Œ  <br/> V=\frac{3}{4}  $
==> B: 0110 100

4. 110 1111
$A: 2^E=2^{6-3}=8ï¼Œ  <br/>M=\frac{15+16}{16}=\frac{31}{16} ï¼Œ  <br/> V=\frac{31}{2} $
1111 å‘ä¸Šèˆå…¥==> 000
$B: 2^E=2^{11-7}=16ï¼Œ  <br/>M=\frac{8}{8}=1ï¼Œ  <br/> V=16  $
==> B: 1011 000

5. 000 0001
$A: 2^E=2^{1-3}=\frac{1}{4}ï¼Œ  <br/>M=\frac{1}{16}ï¼Œ  <br/> V=\frac{1}{64} $
0001 å‘ä¸‹èˆå…¥==> 000
$B: 2^E=2^{1-7}=\frac{1}{64}ï¼Œ  <br/>M=\frac{8}{8}=1ï¼Œ  <br/> V=\frac{1}{64}  $
==> B: 0001 000

***

### ç»ƒä¹ é¢˜ 2.53
å®Œæˆä¸‹åˆ—å®å®šä¹‰ï¼Œç”ŸæˆåŒç²¾åº¦ $+\infty,-\infty$å’Œ0
åŒç²¾åº¦èƒ½å¤Ÿè¡¨ç¤ºçš„æœ€å¤§çš„æœ‰é™æ•°å¤§çº¦æ˜¯$1.8\times10^{308}$

>ä¸æ‡‚ï¼Œæ±‚è§£ç­”

{% codeblock lang:C %}
#define POS_INFINITY  1e400;
#define NEG_INFINITY  (-POS_INFINITY);
#define NEG_ZERO  (-1.0/POS_INFINITY);
{% endcodeblock %}

***

### ç»ƒä¹ é¢˜ 2.54
x,f,dåˆ†åˆ«ä¸º int,float,doubleç±»å‹çš„æ•°å­—

åˆ¤æ–­ä»¥ä¸‹æ¡ä»¶
1. x==(int)(double)x  çœŸ, å› ä¸ºdoubleæ¯”intæ›´é•¿
{% codeblock lang:C %}
int x = pow(2,31)-1;
printf("int x = %d\n",x);
printf("(float)x = %f\n",(float)x);
printf("(int)(float)x = %d\n",(int)(float)x);

//è¾“å‡º
int x = 2147483647  //0x7fffffff  è¿™ä¸ªæ•°å­—åŒ…å«31ä¸ª1,æ‰€ä»¥floatæ²¡æ³•ç²¾ç¡®æ ‡ç¤ºã€‚ ä¸ºå•¥
(float)x = 2147483648.000000
(int)(float)x = -2147483648
{% endcodeblock %}
2. x==(int)(float)x   å‡, floaté•¿åº¦å’Œintç›¸åŒ,æœ‰å¯èƒ½æº¢å‡º, 
ä¾‹å¦‚TMax 0111 1111 1111 1111 1111 1111 1111 1111
floatç±»å‹æœ€å¤šå‘å·¦ç§»åŠ¨23ä½ï¼Œä¹Ÿå°±æ˜¯è¯´floatæ²¡æœ‰åŠæ³•è¡¨ç¤ºè¿™ä¹ˆé•¿çš„ç²¾åº¦ï¼Œè™½ç„¶floatå¯ä»¥è¡¨ç¤ºæ›´å¤§èŒƒå›´çš„æ•°ã€‚æ‰€ä»¥ç›¸å¯¹äºint,floatæ˜¯ç‰ºç‰²äº†ç²¾åº¦ï¼Œç”¨ä¸€äº›éƒ¨åˆ†ä½å½“åšé˜¶ç å»è¡¨ç¤ºæ›´å¤§èŒƒå›´çš„æ•°ã€‚
3. d==(double)(float)d å‡ å½“d=1e40æ—¶,å³è¾¹ä¸ºæ­£æ— ç©·
4. f==(float)(double)f çœŸ
5. f=-(-f) çœŸ,æµ®ç‚¹æ•°æ­£è´Ÿåªæ˜¯æ”¹å˜ç¬¦å·ä½è€Œå·²
6. 1.0/2=1/2.0 çœŸï¼Œè¿ç®—å‰ï¼Œéƒ½ä¼šè½¬æ¢ä¸ºæµ®ç‚¹æ•°
7. d*d >=0.0 çœŸï¼Œè™½ç„¶ä¼šæº¢å‡ºåˆ°$+infty$
8. (f+d)-f=d å‡ æµ®ç‚¹è¿ç®—æ²¡å…·å¤‡ç»“åˆå¾‹

***

### ç»ƒä¹ é¢˜ 2.55-2.57
{% codeblock CSAPP 2.55 lang:C %}
#include <stdio.h>

// å®šä¹‰byte_pointerä¸ºä¸€ä¸ªæŒ‡å‘ unsigned charçš„æŒ‡é’ˆ
typedef unsigned char *byte_pointer;

void show_byte(byte_pointer start, int len){
    int i;
    for (int i = 0; i < len; ++i){
        //format: å¯¹äºæ•´å‹æ•°ï¼Œå°æ•°ç‚¹æŒ‡å®šæ‰“å°çš„æ•°å­—ä½æ•°
        //å¿…è¦æ—¶å¯å¡«å……ä½0ä»¥è¾¾åˆ°è¦æ±‚çš„å®½åº¦
        printf("%.2x",start[i] );
    }
    printf("\n");
}

void show_short(short x){
    show_byte((byte_pointer) &x, sizeof(short));
}

void show_int(int x){
    show_byte((byte_pointer) &x, sizeof(int));
}

void show_long(long x){
    show_byte((byte_pointer) &x, sizeof(long));
}

void show_float(float x){
    show_byte((byte_pointer) &x, sizeof(float));
}

void show_pointer(void *x){
    show_byte((byte_pointer) &x, sizeof(void *));
}

void test_show_byte(int val){
    int ival = val;
    float fval = (float)val;
    int *pval = &ival;
    show_int(ival);
    show_float(fval);
    show_pointer(pval);
}

int main(){
    int val = 0x87654321;
    byte_pointer valp = (byte_pointer)&val;
    show_byte(valp,1);
}

// è¿è¡Œç»“æœä¸º21
// æˆ‘çš„Macæ˜¯å°ç«¯æ³•æœºå™¨
{% endcodeblock %}

***

### ç»ƒä¹ é¢˜ 2.58
åˆ¤æ–­æœºå™¨æ˜¯å¦ä¸ºå°ç«¯æ³•ï¼Œæ˜¯è¿”å›1ï¼Œå¦è¿”å›0
{% codeblock CSAPP 2.58  lang:C%}
int is_little_end(){
    
    // å®šä¹‰aå 4ä¸ªå­—èŠ‚
    int a = 1; 

    // &a å–açš„åœ°å€
    // (char*)&a å°†intæŒ‡é’ˆè½¬æ¢ä¸ºcharæŒ‡é’ˆ
    // *(char*)&a å–è¯¥æŒ‡é’ˆæ‰€åœ¨åœ°å€çš„ç¬¬0ä¸ªå­—èŠ‚ä½œä¸ºä¸€ä¸ªcharè¿”å›
    // *(char*)å–ç¬¬0ä¸ªå­—èŠ‚ï¼Œå› ä¸ºcharåªå ä¸€ä¸ªå­—èŠ‚
    // *(int*)å–å››ä¸ªå­—èŠ‚ï¼Œå› ä¸ºintå å››ä¸ªå­—èŠ‚
    return *((char*)&a);   
}
{% endcodeblock %}
